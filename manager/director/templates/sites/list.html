{% extends "base.html" %}
{% load staticfiles %}

{% block titlesuffix %} - Sites{% endblock %}

{% block head %}
    <link rel="stylesheet" href="{% static 'css/site-list.css' %}">
    <script type="text/javascript" src="{% static 'js/site-list.js' %}"></script>
    {% comment %}
    <script type="text/javascript" src="{% static 'js/search.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/sites/tooltip.js' %}"></script>
  {% endcomment %}
{% endblock %}

{% block navbar %}
    <input class="search-box" data-search="#sites .site" data-fields=".name,.desc,.type" type="text" placeholder="&#xf002; Search Sites">
{% endblock %}

{% block main %}
    <div class="subheading clearfix">
        <h3 class="float-left d-none d-sm-block">{% if show_all %}All{% else %}Your{% endif %} Sites</h3>
        <a href="{% url 'sites:create' %}" class="float-right btn btn-ion"><i class="fas fa-plus"></i><span class="d-none d-md-inline"> Create</span> Site</a>
        {% if not request.user.is_superuser and not request.user.has_webdocs %}
            <a href="{% url 'sites:create_webdocs' %}" class="float-right btn btn-ion" style="margin-right:5px"><i class="fas fa-user-plus"></i><span class="hidden-xs-down"> Create</span> Webdocs</a>
        {% endif %}

        {% if request.user.is_superuser %}
            {% if show_all %}
                <a href="{% url 'auth:index' %}" class="float-right btn btn-ion" style="margin-right:5px"><i class="far fa-star"></i> Hide All</a>
            {% else %}
                <a href="{% url 'auth:index' %}?all=1" class="float-right btn btn-ion" style="margin-right:5px"><i class="fas fa-star"></i> Show All</a>
            {% endif %}
        {% endif %}
    </div>
    <div id="sites">
    {% for site in sites %}
        <a href="{% url 'sites:info' site.id %}" class="site{% if site.type == "dynamic" %} site-dynamic{% endif %}{% if site.user_owns_site %} user-site{% endif %}" id="site-{{ site.id }}" data-site-id="{{ site.id }}">
            {% if site.database %}<span data-toggle="tooltip" class="float-right tag tag-primary tag-database">{{ site.database.get_category_display }}</span>{% endif %}
            <i class="icon float-left fa-2x fa-fw {% if site.purpose == 'user' %}fas fa-user{% elif site.purpose == 'activity' %}fas fa-globe{% elif site.purpose == 'legacy' %}far fa-snowflake{% else %}fas fa-cube{% if site.purpose == 'project' %} project{% endif %}{% endif %}">
                <span class="site-status"></span>
            </i>
            <b class="name">{{ site.name }}</b><span class="sub"><span class="type">{{ site.get_type_display }}</span> - <span class="desc">{{ site.description|default:"No Description" }}</span> - <span class="users">{{ site.users.count }} user{% if site.users.count != 1 %}s{% endif %}</span></span>
        </a>
    {% endfor %}
    {% if sites.count == 0 %}
    <div id="empty">You don't have any sites! Click <a href="{% url 'sites:create' %}">here</a> to create a new site.</div>
    {% endif %}
    </div>
{% endblock %}
